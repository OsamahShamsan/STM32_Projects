#include "vt100.h"
#include "uart_dma.h"
#include <string.h>
#include <stdio.h>

// Private raw send, invisible outside vt100.c
static void vt100_send(const char* str) {
    uart_dma_send((const uint8_t*)str, strlen(str));
}

// UI-specific safe wrappers only
void vt100_print_menu_line(const char* text, int is_selected) {
    vt100_send(is_selected ? "> " : "  ");
    vt100_send(text);
}

void vt100_print_info_line(const char* text) {
    vt100_send(text);
    vt100_send("\r\n");
}

void vt100_goto(uint8_t row, uint8_t col) {
    char cmd[32];
    snprintf(cmd, sizeof(cmd), "\033[%d;%dH", row, col);
    vt100_send(cmd);
}

void vt100_goto_line(uint8_t line) {
    vt100_goto(line, 1);
}

void vt100_clear_screen(void) {
    vt100_send(VT100_CLEAR_SCREEN);
    vt100_send(VT100_CURSOR_HOME);
}

void vt100_clear_line(void) {
    vt100_send(VT100_CLEAR_LINE);
}

void vt100_cursor_hide(void) {
    vt100_send(VT100_CURSOR_HIDE);
}

void vt100_cursor_show(void) {
    vt100_send(VT100_CURSOR_SHOW);
}

void vt100_set_color(const char* attr) {
    if (attr) vt100_send(attr);
}

void vt100_reset_color(void) {
    vt100_send(VT100_RESET);
}
